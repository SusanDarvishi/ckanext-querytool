{#

Creates layout for a query tool fields.

title - The title of the query tool.
description - description what kind of data is in the query tool.
name - name of the query tool (unique)

Example usage:
  {% snippet 'querytool/snippets/edit_data_form.html', data=data, errors= errors%}

#}
{% import 'macros/form.html' as form %}

{% if querytool %}
  {% set action_url = h.url_for('querytool_edit', querytool= '/' + querytool.name) %}
{% else %}
  {% set action_url = h.url_for('querytool_edit', querytool= '') %}
{% endif %}
<form method="post" action="{{ action_url }}" class="form-horizontal col-sm-12" id="">
{% block stages %}
  {% snippet 'querytool/admin/snippets/stages.html', stages=['active', 'complete'] %}
{% endblock %}
  {{ form.input('title', id='field-title', label=_('Title'), placeholder=_('Title of the query tool'), value=data.title, error=errors.title, classes=['control-full', 'control-large'], attrs={'data-module': 'slug-preview-target', 'class': 'form-control'}) }}


  {% set prefix = h.url_for('querytool_edit', querytool= '') %}
  {% set domain = h.url_for('querytool_edit', querytool= '') %}
  {% set domain = domain|replace("http://", "")|replace("https://", "") %}
  {% set attrs = {'data-module': 'slug-preview-slug', 'data-module-prefix': domain + '/', 'data-module-placeholder': '<querytool>', 'class': 'form-control input-sm'} %}

  {{ form.prepend('name', id='field-name', label=_('URL'), prepend=prefix + '/', placeholder=_('eg. my-querytool'), value=data.name, error=errors.name, attrs=attrs, is_required=true) }}

  {{ form.markdown('description', id='field-description', label=_('Description'), placeholder=_('eg. Some useful description about the query tool'), value=data.description, error=errors.description) }}{% block querytool_datasets %}

  {% set datasets = h.querytool_get_datasets() %}
  <div class="control-group">
      <label class="control-label" for="field-datasets"><span title="This field is required" class="control-required">*</span>{{ _("Dataset") }}</label>
      <div class="controls">
          <select id="field-datasets" name="topic_id" data-module="autocomplete">
              {% for dataset in datasets %}
              <option value="{{ dataset }}" {{ 'selected' if data.name == data.name }}>{{ dataset }}</option>
              {% endfor %}
          </select>
      </div>
  </div>
  {% endblock %}

<div class="form-actions">
  <button type="submit" class="btn btn-primary" name="save">{{ _('Set visualisations') }}</button>
</div>
</form>